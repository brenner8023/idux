import{H as x,y as g,Q as U,U as P,D as q,K as S,af as X,ag as Q,G as J,f as ye,a4 as Ce,o as C,ad as $,d as V,as as Y,a8 as R,r as E,ah as w,e as A,a7 as j,at as Z,N as M,ac as z,b as B,a3 as T,F as W,ae as ee,c as N,a as ge,w as H,a2 as $e}from"./vendor.01b03999.js";import{c as s,f as te,t as Ie,D as Se,a7 as ke,u as we,a8 as Oe,a9 as Ee,w as Me,x as Pe,a3 as ne}from"./index.b0bc66d4.js";import{I as Re}from"./index.4ab36dc8.js";import{I as Ve}from"./index.1ed0c2b7.js";import{u as xe}from"./index.1697be33.js";var Be=Object.defineProperty,G=Object.getOwnPropertySymbols,se=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable,ie=(e,o,t)=>o in e?Be(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,re=(e,o)=>{for(var t in o||(o={}))se.call(o,t)&&ie(e,t,o[t]);if(G)for(var t of G(o))ae.call(o,t)&&ie(e,t,o[t]);return e},ue=(e,o)=>{var t={};for(var l in e)se.call(e,l)&&o.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&G)for(var l of G(e))o.indexOf(l)<0&&ae.call(e,l)&&(t[l]=e[l]);return t},D=(e,o)=>{for(const[t,l]of o)e[t]=l;return e};const De=x({props:{value:s.any,autofocus:s.bool,disabled:s.bool,open:s.bool,showInput:s.bool,showMirror:s.bool},emits:["compositionstart","compositionend","input","change","focus","blur"],setup(e,{emit:o}){const t=g(""),l=g(null),i=g(null),c=()=>{if(e.showMirror){const a=l.value,h=i.value;h.innerText=` ${a.value}`,t.value=`${h.scrollWidth}px`}},n=g(!1),r=a=>{n.value=!0,o("compositionstart",a)},p=a=>{n.value&&(n.value=!1,d(a)),o("compositionend",a)},d=a=>{if(o("input",a),n.value)return;const{value:h}=a.target;o("change",h),c()},m=a=>{l.value.focus(a)},v=()=>{l.value.blur()},u=()=>{const a=l.value;a.value="",o("change",""),c()};return U(()=>{P(()=>e.open,a=>a&&m(),{immediate:!0}),c()}),{inputWidth:t,inputRef:l,mirrorRef:i,onCompositionStart:r,onCompositionEnd:p,onInput:d,focus:m,blur:v,clear:u}}}),Fe=["value","autofocus","disabled"],Te={key:0,ref:"mirrorRef",class:"ix-select-input-mirror","aria-hidden":"true"};function We(e,o,t,l,i,c){return C(),$("div",{class:"ix-select-input",style:Y({width:e.inputWidth})},[V("input",{ref:"inputRef",class:"ix-select-input-inner",value:e.value,autocomplete:"off",autofocus:e.autofocus,disabled:e.disabled,style:Y({opacity:e.showInput?void 0:0}),onInput:o[0]||(o[0]=(...n)=>e.onInput&&e.onInput(...n)),onCompositionstart:o[1]||(o[1]=(...n)=>e.onCompositionStart&&e.onCompositionStart(...n)),onCompositionend:o[2]||(o[2]=(...n)=>e.onCompositionEnd&&e.onCompositionEnd(...n)),onFocus:o[3]||(o[3]=n=>e.$emit("focus",n)),onBlur:o[4]||(o[4]=n=>e.$emit("blur",n))},null,44,Fe),e.showMirror?(C(),$("span",Te,null,512)):R("v-if",!0)],4)}var He=D(De,[["render",We]]);const Ke=x({components:{IxIcon:te},props:{removeable:s.bool,disabled:s.bool,label:s.string},emits:["delete"]}),Le={class:"ix-select-item-label"};function Ae(e,o,t,l,i,c){const n=E("IxIcon");return C(),$("div",{class:z(["ix-select-item",{"ix-select-item-disabled":e.disabled}])},[V("span",Le,[w(e.$slots,"default",{},()=>[A(j(e.label),1)])]),e.removeable&&!e.disabled?(C(),$("span",{key:0,class:"ix-select-item-remove",onClick:o[0]||(o[0]=Z(r=>e.$emit("delete"),["stop"]))},[M(n,{name:"close"})])):R("v-if",!0)],2)}var je=D(Ke,[["render",Ae]]);/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const ce=Symbol("selectToken"),_=Symbol("visibleChangeToken");/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const ze=(e,o)=>e===o,Ne={value:s.any,control:Ie,open:s.bool.def(!1),autofocus:s.bool.def(!1),borderless:s.bool,clearable:s.bool,compareWith:s.func().def(ze),disabled:s.bool.def(!1),overlayClass:s.string,empty:s.oneOfType([String,s.object()]),filterOption:s.oneOfType([Boolean,s.func()]).def(!0),inputable:s.bool,maxLabelCount:s.number.def(Number.MAX_SAFE_INTEGER),multiple:s.bool.def(!1),multipleLimit:s.number.def(Number.MAX_SAFE_INTEGER),labelKey:s.string,options:s.array(),placeholder:s.string,searchable:s.bool,size:s.oneOf(["lg","md","sm"]),suffix:s.string,valueKey:s.string,virtual:s.bool.def(!1),"onUpdate:value":s.emit(),"onUpdate:open":s.emit(),onChange:s.emit(),onClear:s.emit(),onCompositionStart:s.emit(),onCompositionEnd:s.emit(),onBlur:s.emit(),onFocus:s.emit(),onInput:s.emit(),onOverlayScroll:s.emit()},Ge={disabled:s.bool.def(!1),label:s.string.isRequired,value:s.any.isRequired},_e={label:s.string.isRequired,options:s.array().def(()=>[])},Ue=(e,o)=>o.label.toLowerCase().includes(e.toLowerCase()),qe=x({name:"IxSelectOption",components:{IxCheckbox:Ve},props:Ge,setup(e){const{selectProps:o,inputValue:t,activatedValue:l,activateHandler:i,selectedValue:c,selectHandler:n,selectOptionHandler:r}=q(ce)||{},p=S(()=>{const b=t==null?void 0:t.value,O=o==null?void 0:o.filterOption;return b&&O?(ye(O)?O:Ue)(b,e):!0}),d=S(()=>o==null?void 0:o.compareWith(l==null?void 0:l.value,e.value)),m=S(()=>!!(c==null?void 0:c.value.some(b=>o==null?void 0:o.compareWith(b,e.value))));P(m,b=>X(()=>r==null?void 0:r(b,e)),{immediate:p.value});const v=S(()=>{const b=e.disabled;return{"ix-select-option":!0,"ix-select-option-disabled":b,"ix-select-option-active":!b&&d.value,"ix-select-option-selected":!b&&m.value}}),u=S(()=>o==null?void 0:o.multiple),a=()=>{e.disabled||i==null||i(e.value)},h=()=>{e.disabled||n==null||n(e.value)},y=q(_);return P(p,b=>X(()=>y==null?void 0:y(b)),{immediate:!0}),Q(()=>{p.value&&(y==null||y(!1))}),{visible:p,classes:v,showCheckbox:u,selected:m,onMouseEnter:a,onClick:h}}}),Xe={key:0,class:"ix-select-option-checkbox"},Qe={class:"ix-select-option-label"};function Je(e,o,t,l,i,c){const n=E("IxCheckbox");return B((C(),$("div",{class:z(e.classes),onMouseenter:o[0]||(o[0]=(...r)=>e.onMouseEnter&&e.onMouseEnter(...r)),onClick:o[1]||(o[1]=Z((...r)=>e.onClick&&e.onClick(...r),["stop"]))},[e.showCheckbox?(C(),$("span",Xe,[M(n,{checked:e.selected,disabled:e.disabled,readonly:""},null,8,["checked","disabled"])])):R("v-if",!0),V("span",Qe,[w(e.$slots,"default",{},()=>[A(j(e.label),1)])])],34)),[[T,e.visible]])}var oe=D(qe,[["render",Je]]);const Ye=x({name:"IxSelectOptionGroup",components:{SelectOption:oe},props:_e,setup(){const e=g(0),o=S(()=>e.value>0);J(_,i=>{i?e.value++:e.value--});const l=q(_);return P(o,i=>X(()=>l==null?void 0:l(i)),{immediate:o.value}),Q(()=>{o.value&&(l==null||l(!1))}),{visible:o}}}),Ze={class:"ix-select-option-group"},eo={class:"ix-select-option-group-label"};function oo(e,o,t,l,i,c){const n=E("SelectOption");return C(),$(W,null,[B(V("div",Ze,[V("span",eo,[w(e.$slots,"label",{},()=>[A(j(e.label),1)])])],512),[[T,e.visible]]),(C(!0),$(W,null,ee(e.options,r=>(C(),N(n,{key:r.value,disabled:r.disabled,label:r.label,value:r.value},null,8,["disabled","label","value"]))),128)),e.options.length?R("v-if",!0):w(e.$slots,"default",{key:0})],64)}var lo=D(Ye,[["render",oo]]);const to=x({components:{SelectOption:oe,SelectOptionGroup:lo,IxEmpty:Re},props:{options:s.array().def(()=>[]),empty:s.string},setup(){const e=g(0),o=S(()=>e.value===0);return J(_,l=>{l?e.value++:e.value--}),{isEmpty:o}}}),no={class:"ix-select-option-container"};function so(e,o,t,l,i,c){const n=E("SelectOptionGroup"),r=E("SelectOption"),p=E("IxEmpty");return C(),$("div",no,[(C(!0),$(W,null,ee(e.options,d=>(C(),$(W,{key:d.value},[d.children?(C(),N(n,{key:0,label:d.label,options:d.children},null,8,["label","options"])):(C(),N(r,{key:1,disabled:d.disabled,label:d.label,value:d.value},null,8,["disabled","label","value"]))],64))),128)),e.options.length?R("v-if",!0):w(e.$slots,"default",{key:0}),B(V("div",null,[w(e.$slots,"empty",{},()=>[M(p,{description:e.empty},null,8,["description"])])],512),[[T,e.isEmpty]])])}var ao=D(to,[["render",so]]);/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const io=e=>{const t=xe({scrollStrategy:"reposition",placement:"bottom",trigger:"manual",offset:[0,8],hideDelay:0,showDelay:0}),{triggerRef:l,overlayRef:i,initialize:c,destroy:n,visibility:r,show:p,hide:d,update:m}=t,v=g(""),u=S(()=>{const y=32,b=8,O=8;return y*b+O+"px"}),a=()=>{var y;v.value=((y=l.value)==null?void 0:y.getBoundingClientRect().width)+"px"},h=()=>{a(),e.multiple&&m()};return U(()=>{c(),a(),Oe(l.value,h),P(()=>e.open,y=>y?p():d(),{immediate:!0}),e.autofocus&&p(100)}),Q(()=>{Ee(l.value,h),n()}),{triggerRef:l,overlayRef:i,visibility:r,show:p,hide:d,overlayMinWidth:v,overlayMaxHeight:u}},ro=(e,o)=>S(()=>{const t=e.options||[],l=e.labelKey||o.labelKey,i=e.valueKey||o.valueKey,c=[],n=new Map;return t.forEach(r=>{const p={label:r[l],value:r[i],disabled:r.disabled},d=r.groupLabel;if(d)if(n.has(d))n.get(d).children.push(p);else{const m={label:d,value:d,children:[p]};n.set(d,m)}else c.push(p)}),n.forEach(r=>c.push(r)),c}),uo=e=>{const{emit:o}=Ce(),{accessor:t,control:l}=Me();Pe(l);const i=S(()=>t.disabled.value),c=g(""),n=g(ne(t.valueRef.value)),r=g(null),p=g(!1),d=g(!1),m=g(!0),v=()=>{const f=n.value.length===0;d.value=e.multiple||!f&&!p.value&&!c.value,m.value=f&&!p.value&&!c.value},u=f=>{n.value=[],v(),o("clear",f)},a=f=>{n.value=n.value.filter(I=>!e.compareWith(f.value,I))},h=f=>{p.value=!0,v(),o("compositionstart",f)},y=f=>{p.value&&(p.value=!1,v()),o("compositionend",f)},b=f=>{f!==c.value&&(c.value=f,v(),o("inputChange",f))},O=g(!1),K=f=>{O.value=!0,o("focus",f)},F=f=>{var I;(I=t.markAsBlurred)==null||I.call(t),O.value=!1,o("blur",f)};return P(()=>t.valueRef.value,f=>{const I=ne(f);(I.length!==0||n.value.length!==0)&&(n.value=I,v())}),P(()=>n.value,f=>{const I=e.multiple?f:f[0];t.valueRef.value!==I&&(t.setValue(I),o("change",I))}),U(()=>{v()}),{disabled:i,inputValue:c,activatedValue:r,selectedValue:n,showItem:d,showPlaceholder:m,isActive:O,onClear:u,onItemDelete:a,onCompositionStart:h,onCompositionEnd:y,onInputValueChange:b,onFocus:K,onBlur:F}},co=(e,o,t,l,i)=>S(()=>{var c,n,r,p,d;const m=e.multiple,v=(c=e.borderless)!=null?c:o.borderless,u=(n=e.clearable)!=null?n:o.clearable,a=(r=e.searchable)!=null?r:o.searchable,h=(p=e.size)!=null?p:o.size,y=(d=e.suffix)!=null?d:o.suffix,b=i.value;return{"ix-select":!0,"ix-select-single":!m,"ix-select-multiple":m,"ix-select-opened":t.value,"ix-select-active":l.value,"ix-select-borderless":v,"ix-select-disabled":b,"ix-select-clearable":!b&&u,"ix-select-searchable":!b&&(a||m),"ix-select-show-suffix":!!y||!m,[`ix-select-${h}`]:!0}}),po=()=>{const e=g(null);return{selectInput:e,focus:()=>{var i;(i=e.value)==null||i.focus()},blur:()=>{var i;(i=e.value)==null||i.blur()},clear:()=>{var i;(i=e.value)==null||i.clear()}}},vo=(e,o,t,l,i,c,n,r)=>{J(ce,{selectProps:e,inputValue:o,activatedValue:t,activateHandler:v=>{t.value=v},selectedValue:l,selectHandler:v=>{const u=l.value,a=u.findIndex(h=>e.compareWith(h,v));e.multiple?(a===-1?u.length<e.multipleLimit&&(l.value=[...u,v]):l.value=u.filter((h,y)=>y!==a),n(),r()):(a===-1&&(l.value=[v]),c())},selectOptionHandler:(v,u)=>{let a=i.value;const h=a.findIndex(y=>e.compareWith(y.value,u.value));e.multiple?v?a=h===-1?[...a,u]:a:a=h>-1?a.filter((y,b)=>b!==h):a:v?a=[u]:h>-1&&(a=[]),i.value=a}})},fo=x({name:"IxSelect",components:{IxPortal:Se,IxIcon:te,SelectItem:je,SelectInput:He,SelectOptionContainer:ao},directives:{clickOutside:ke},props:Ne,emits:["update:value","update:open","blur","change","clear","focus","scrollToBottom","compositionstart","compositionend","input","inputChange"],setup(e,{emit:o}){const t=we("select"),l=g([]),i=io(e),{visibility:c,show:n,hide:r}=i,p=ue(i,["visibility","show","hide"]),d=ro(e,t),m=uo(e),{disabled:v,inputValue:u,activatedValue:a,selectedValue:h,isActive:y}=m,b=ue(m,["disabled","inputValue","activatedValue","selectedValue","isActive"]),O=co(e,t,c,y,v),{selectInput:K,focus:F,blur:f,clear:I}=po();vo(e,u,a,h,l,r,F,I);const de=S(()=>{const k=e.maxLabelCount,L=l.value,le=L.slice(0,k);if(L.length>k){const be=`+ ${L.length-k} ...`,he=L.slice(k);le.push({label:be,value:he,disabled:!1,isMax:!0})}return le}),pe=()=>r(),ve=()=>{v.value||(e.multiple&&F(),!(c.value&&(e.searchable||e.multiple))&&(c.value?r():n()))},fe=k=>{console.log("Todo onKeyDown",k)};P(c,k=>{k||I(),o("update:open",k)});const me=S(()=>{const k=e.suffix;return k||(e.searchable&&y.value?"search":"down")});return re(re({disabled$$:v,focus:F,blur:f,onClickOutside:pe,classes:O,onClick:ve,onKeyDown:fe,selectedItems:de,selectInput:K,inputValue:u,suffixIcon:me,visibility:c,normalOptions:d},p),b)}}),mo={key:0,class:"ix-select-placeholder"},bo={key:0,class:"ix-select-suffix"};function ho(e,o,t,l,i,c){const n=E("SelectItem"),r=E("SelectInput"),p=E("IxIcon"),d=E("SelectOptionContainer"),m=E("IxPortal"),v=ge("click-outside");return B((C(),$("div",{ref:"triggerRef",class:z(e.classes),onClick:o[3]||(o[3]=(...u)=>e.onClick&&e.onClick(...u))},[V("div",{class:"ix-select-selector",onKeydown:o[1]||(o[1]=(...u)=>e.onKeyDown&&e.onKeyDown(...u))},[(C(!0),$(W,null,ee(e.selectedItems,u=>B((C(),N(n,{key:u.value,removeable:e.multiple&&!u.isMax,disabled:e.disabled$$||u.disabled,label:u.label,onDelete:a=>e.onItemDelete(u)},{default:H(()=>[u.isMax?w(e.$slots,"customMaxLabel",{key:0,option:u}):w(e.$slots,"customLabel",{key:1,option:u})]),_:2},1032,["removeable","disabled","label","onDelete"])),[[T,e.showItem]])),128)),M(r,{ref:"selectInput",value:e.inputValue,autofocus:e.autofocus,disabled:e.disabled$$,open:e.open,showInput:e.multiple||e.searchable||e.inputable,showMirror:e.multiple,onChange:e.onInputValueChange,onInput:o[0]||(o[0]=u=>e.$emit("input",u)),onCompositionstart:e.onCompositionStart,onCompositionend:e.onCompositionEnd,onFocus:e.onFocus,onBlur:e.onBlur},null,8,["value","autofocus","disabled","open","showInput","showMirror","onChange","onCompositionstart","onCompositionend","onFocus","onBlur"]),e.showPlaceholder?(C(),$("div",mo,[w(e.$slots,"placeholder",{},()=>[A(j(e.placeholder),1)])])):R("v-if",!0)],32),e.suffix||e.$slots.suffix||!e.multiple?(C(),$("div",bo,[w(e.$slots,"suffix",{},()=>[M(p,{name:e.suffixIcon},null,8,["name"])])])):R("v-if",!0),e.clearable&&!e.disabled$$&&e.selectedItems.length?(C(),$("div",{key:1,class:"ix-select-clear",onClick:o[2]||(o[2]=Z((...u)=>e.onClear&&e.onClear(...u),["stop"]))},[M(p,{name:"close-circle"})])):R("v-if",!0),M(m,{target:"ix-select-container"},{default:H(()=>[M($e,null,{default:H(()=>[B(M(d,{ref:"overlayRef",class:z(e.overlayClass),style:Y({minWidth:e.overlayMinWidth,maxHeight:e.overlayMaxHeight}),options:e.normalOptions,empty:e.empty},{empty:H(()=>[w(e.$slots,"empty")]),default:H(()=>[w(e.$slots,"default")]),_:3},8,["class","style","options","empty"]),[[T,e.visibility]])]),_:3})]),_:3})],2)),[[v,e.onClickOutside]])}var yo=D(fo,[["render",ho]]);/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const ko=yo,wo=oe;export{wo as I,ko as a};
