import{c as e,u as l,g as a,h as n,o as t,i as r,j as s,s as i,k as o}from"./index.3d3216c0.js";import{E as u,G as c,H as v,v as f,D as h,a1 as k,s as d,U as p,u as g,y as m}from"./vendor.56ae3a09.js";const x=Symbol("anchorToken"),L={affix:e.bool.def(!0),bounds:e.number,hideLinkBall:e.bool,offsetTop:e.number,target:e.oneOfType([String,HTMLElement]),targetOffset:e.number,onChange:e.emit(),onClick:e.emit()},b={href:e.string.isRequired,title:e.string};var T=u({name:"IxAnchor",props:L,setup(e,{slots:n}){const t=l("anchor"),r=c((()=>{var l;return null!=(l=e.hideLinkBall)?l:t.hideLinkBall})),s=c((()=>{const{offsetTop:l}=e;return{maxHeight:l?`calc(100vh - ${l}px)`:"100vh"}})),{activeLink:i}=C(e,t),{anchorRef:o,inkBallClasses:u,inkBallTop:f}=B(i);return()=>{var l;const t=r.value?null:v("span",{class:u.value,style:{top:f.value}},null),i=v("div",{class:"ix-anchor-wrapper",style:s.value},[v("div",{class:"ix-anchor",ref:o},[v("div",{class:"ix-anchor-ink"},[t]),null==(l=n.default)?void 0:l.call(n)])]);return e.affix?v(a,{target:e.target,offset:e.offsetTop},{default:()=>[i]}):i}}});const C=(e,l)=>{const a=f([]),n=f(),{scrollTo:t}=E(e,l,a,(l=>{n.value!==l&&(n.value=l,s(e.onChange,l))}));return h(x,{registerLink:e=>{a.value.includes(e)||a.value.push(e)},unregisterLink:e=>{const l=a.value.indexOf(e);-1!==l&&a.value.splice(l,1)},activeLink:n,handleLinkClick:(l,a)=>{s(e.onClick,l,a),t(a.href)}}),{activeLink:n}},B=e=>{const l=f(),a=c((()=>({"ix-anchor-ink-ball":!0,"ix-anchor-ink-ball-visible":!!e.value}))),n=f();return k((()=>{d((()=>{var a;const t=null==(a=l.value)?void 0:a.querySelector(`a[data-href="${e.value}"]`);if(!t)return;const{offsetTop:r,clientHeight:s}=t;n.value=r+s/2-4.5+"px"}))})),{anchorRef:l,inkBallClasses:a,inkBallTop:n}},y=(e,l)=>{const a=document.getElementById(e.split("#")[1]);if(a){const{top:e}=o(a,l);return e}return null},E=(e,l,a,s)=>{const o=c((()=>{var a;return null!=(a=e.bounds)?a:l.bounds})),u=f(),v="scroll";let h=!1;const d=c((()=>{var l,a;return null!=(a=null!=(l=e.targetOffset)?l:e.offsetTop)?a:0})),m=()=>{if(h)return;const e=((e,l,a,n)=>e.reduce(((e,t)=>{const r=y(t,l);return null!==r&&r<a+n&&e.top<r?{link:t,top:r}:e}),{link:"",top:Number.MIN_SAFE_INTEGER}).link)(a.value,u.value,d.value,o.value);s(e)};return p((()=>e.target),(()=>{r(u.value,v,m),u.value=n(e.target),t(u.value,v,m),m()})),k((()=>{u.value=n(e.target),t(u.value,v,m),m()})),g((()=>{r(u.value,v,m)})),{scrollTo:e=>{s(e);const l=y(e,u.value);null!==l&&(h=!0,i({amountOfChange:l-d.value,target:u.value,callback:()=>{h=!1}}))}}};const I=T,O=u({name:"IxAnchorLink",props:b,setup(e,{slots:l}){const{registerLink:a,unregisterLink:n,activeLink:t,handleLinkClick:r}=m(x);p((()=>e.href),((e,l)=>{n(l),a(e)})),k((()=>a(e.href))),g((()=>n(e.href)));const s=c((()=>t.value===e.href)),i=c((()=>({"ix-anchor-link-title":!0,"ix-anchor-link-title-active":s.value}))),o=l=>r(l,e);return()=>{var a,n,t;const{href:r,title:s}=e;return v("div",{class:"ix-anchor-link"},[v("a",{class:i.value,href:r,"data-href":r,title:s,onClick:o},[null!=(n=null==(a=l.title)?void 0:a.call(l))?n:s]),null==(t=l.default)?void 0:t.call(l)])}}});export{I,O as a};
