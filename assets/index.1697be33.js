import{c as M,E as L,F as U,o as E,i as m}from"./index.b0bc66d4.js";import{y as I,K as V,s as W,v as B,a0 as C,af as G,U as P}from"./vendor.01b03999.js";var J=Object.defineProperty,N=Object.defineProperties,Q=Object.getOwnPropertyDescriptors,q=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable,z=(o,e,r)=>e in o?J(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r,Z=(o,e)=>{for(var r in e||(e={}))X.call(e,r)&&z(o,r,e[r]);if(q)for(var r of q(e))Y.call(e,r)&&z(o,r,e[r]);return o},ee=(o,e)=>N(o,Q(e));const S=o=>V(()=>{const e=o.value;return e===null?null:U(e)?e:e.$el});function re({offset:o,arrow:e,arrowOffset:r,showArrow:f},c=[]){const l=[{name:"offset",options:{offset:o}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}}];return f&&l.push({name:"arrow",options:{element:e,padding:r!=null?r:5}}),l.push(...c),l}const te=o=>{const{placement:e,popperOptions:r,offset:f,arrow:c,arrowOffset:l,showArrow:T}=o;return ee(Z({placement:e},r),{modifiers:re({offset:f,arrow:c,arrowOffset:l,showArrow:T},r==null?void 0:r.modifiers)})};var oe=Object.defineProperty,ne=Object.defineProperties,se=Object.getOwnPropertyDescriptors,A=Object.getOwnPropertySymbols,ae=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable,F=(o,e,r)=>e in o?oe(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r,ie=(o,e)=>{for(var r in e||(e={}))ae.call(e,r)&&F(o,r,e[r]);if(A)for(var r of A(e))le.call(e,r)&&F(o,r,e[r]);return o},ce=(o,e)=>ne(o,se(e));const ve=o=>{const e=I(null),r=I(null),f=I(null),c=S(e),l=S(r),T=S(f);let a=null,O=null,u=null;const n=W(o);let g=null;const R=()=>{g&&g(),g=B(()=>{a&&m(window,"scroll",j);const t=c.value,s=l.value,i=T.value;if(!t||!s)return;const p=te(ce(ie({},n),{arrow:i}));a=C(t,s,p),a.update(),E(window,"scroll",j)})},y=t=>{n.visible=t},D=()=>{O&&(clearTimeout(O),O=null),u&&(clearTimeout(u),u=null)},h=t=>{D();const s=t!=null?t:n.showDelay;s>0?O=setTimeout(()=>{y(!0)},s):y(!0)},v=t=>{D();const s=t!=null?t:n.hideDelay;s>0?u=setTimeout(()=>{y(!1)},s):y(!1)},K=()=>{g&&g(),a&&(a.destroy(),a=null,m(window,"scroll",j))},H=t=>{Object.assign(n,t),a?(t&&a.setOptions(t),a.update()):G(()=>R())},j=()=>{!d.value||!a||n.scrollStrategy==="close"&&v(0)},d=V(()=>!n.disabled&&!!n.visible);P(d,()=>H());const _=t=>{switch(t.stopPropagation(),t.type){case"click":{d.value?v():h();break}case"contextmenu":{t.preventDefault(),d.value?v():h();break}case"mouseenter":case"focus":{h();break}case"mouseleave":case"blur":{v();break}}},w=t=>{switch(t.type){case"click":{t.stopPropagation();break}case"mouseenter":{n.allowEnter&&u&&(clearTimeout(u),u=null);break}case"mouseleave":{n.allowEnter&&n.trigger==="hover"&&v();break}}},k={click:["click"],focus:["focus","blur"],hover:["mouseenter","mouseleave"],contextmenu:["contextmenu"],manual:[]},$=["mouseenter","mouseleave","click"];return P(()=>n.trigger,(t,s)=>{const i=c.value,p=l.value;(k[s]||[]).forEach(b=>m(i,b,_)),$.forEach(b=>m(p,b,w)),t!=="manual"&&(k[t].forEach(x=>E(i,x,_)),$.forEach(x=>E(p,x,w)))}),P(c,(t,s)=>{(k[n.trigger]||[]).forEach(p=>{m(s,p,_),E(t,p,_)})},{flush:"post"}),P(l,(t,s)=>{n.trigger!=="manual"&&$.forEach(i=>{m(s,i,w),E(t,i,w)})},{flush:"post"}),{triggerRef:e,overlayRef:r,arrowRef:f,initialize:R,show:h,hide:v,update:H,destroy:K,id:L("ix-overlay"),visibility:d,triggerEventHandler:_,overlayEventHandler:w}};/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */M.oneOf(["click","hover","focus","contextmenu","manual"]);M.oneOf(["auto","auto-start","auto-end","top","left","bottom","right","top-start","top-end","bottom-start","bottom-end","right-start","right-end","left-start","left-end"]);export{ve as u};
